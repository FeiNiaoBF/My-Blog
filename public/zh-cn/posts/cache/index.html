<!doctype html><html lang=zh-cn dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Cache Note | Yeelight の 小屋</title><meta name=keywords content><meta name=description content="主要的资料来源: cs61c cache可以说是计算机技术革命中最伟大的想法了 想一个问题：在我们的电脑里，指令是怎么控制内存里的东西的？因为我们要运行电"><meta name=author content="Yeelight"><link rel=canonical href=https://clever-klepon-d14cb6.netlify.app/zh-cn/posts/cache/><link crossorigin=anonymous href=/assets/css/stylesheet.62aa25427797f8efd87301a5b69795dc50df2dbe79a5fba0648cc7bb8dbcd7c9.css integrity="sha256-YqolQneX+O/YcwGltpeV3FDfLb55pfugZIzHu42818k=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.acb54fd32bbc1982428b8850317e45d076b95012730a5936667e6bc21777692a.js integrity="sha256-rLVP0yu8GYJCi4hQMX5F0Ha5UBJzClk2Zn5rwhd3aSo=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://clever-klepon-d14cb6.netlify.app/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://clever-klepon-d14cb6.netlify.app/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://clever-klepon-d14cb6.netlify.app/favicon-32x32.png><link rel=apple-touch-icon href=https://clever-klepon-d14cb6.netlify.app/apple-touch-icon.png><link rel=mask-icon href=https://clever-klepon-d14cb6.netlify.app/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.2/dist/katex.min.css integrity=sha384-bYdxxUwYipFNohQlHt0bjN/LCpueqWz13HufFEV1SUatKs1cm4L6fFgCi1jT643X crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.2/dist/katex.min.js integrity=sha384-Qsn9KnoKISj6dI8g7p1HBlNpVx0I8p1SvlwOldgi3IorMle61nQy4zEahWYtljaz crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.2/dist/contrib/auto-render.min.js integrity=sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05 crossorigin=anonymous></script>
<script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1},{left:"\\[",right:"\\]",display:!0}],throwOnError:!1})})</script><meta property="og:title" content="Cache Note"><meta property="og:description" content="主要的资料来源: cs61c cache可以说是计算机技术革命中最伟大的想法了 想一个问题：在我们的电脑里，指令是怎么控制内存里的东西的？因为我们要运行电"><meta property="og:type" content="article"><meta property="og:url" content="https://clever-klepon-d14cb6.netlify.app/zh-cn/posts/cache/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-04-14T18:40:46+08:00"><meta property="article:modified_time" content="2023-04-14T18:40:46+08:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Cache Note"><meta name=twitter:description content="主要的资料来源: cs61c cache可以说是计算机技术革命中最伟大的想法了 想一个问题：在我们的电脑里，指令是怎么控制内存里的东西的？因为我们要运行电"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://clever-klepon-d14cb6.netlify.app/zh-cn/posts/"},{"@type":"ListItem","position":2,"name":"Cache Note","item":"https://clever-klepon-d14cb6.netlify.app/zh-cn/posts/cache/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Cache Note","name":"Cache Note","description":"主要的资料来源: cs61c cache可以说是计算机技术革命中最伟大的想法了 想一个问题：在我们的电脑里，指令是怎么控制内存里的东西的？因为我们要运行电","keywords":[],"articleBody":"主要的资料来源: cs61c\ncache可以说是计算机技术革命中最伟大的想法了\n想一个问题：在我们的电脑里，指令是怎么控制内存里的东西的？因为我们要运行电脑除了CPU以外我们要向外拿取数据才能执行一系列的指令，这样电脑才算运行起来。\n让我们来看下面的这张图，这是十分完整的计算机组成结构：\nComponents of a Computer 我们可以从中看到在CPU需要运行一个进程的时候，首先会将指令告诉主存（main memory）,然后开始在主存中找地址（Address）找到后加载到在CPU内部通用寄存器（register）然后开始执行 执行完后再写入主存中。\n在这里面还有一个步骤，memory要先向disk中读取数据\n其实现实中，CPU通用寄存器的速度和主存之间存在着太大的差异。两者之间的速度大致如下关系：\nOh!!!它们相差1,000倍左右，这是无法想像的，就比如当我前1ns的时候CPU已经做完了，而我还要等1000ns的memory的时间，因此在我们看来CPU此时是空闲的，大大的浪费了。\n因此，如果我们可以提升主存的速度，那么对于系统来说将会获得很大的性能提升。但我们试图提升主存的速度和容量，又期望其成本很低，这就有点难为人了。因此，我们有一种折中的方法，那就是制作一块速度极快但是容量极小的存储设备。那么其成本也不会太高。这块存储设备我们称之为cache。在硬件上，我们将cache放置在CPU和主存之间，作为主存数据的缓存。 当CPU试图从主存中load/store数据的时候， CPU会首先从cache中查找对应地址的数据是否缓存在cache 中。如果其数据缓存在cache中，直接从cache中拿到数据并返回给CPU。\n其实类比的话，我蛮喜欢CS61c里面的Library Analogy，而我自己的想法是有点像现在的物流运输：对一些物品都有一个主要的仓库，而也有一些本地仓，当我要送东西的时候我先去看看本地仓有没有，没有就再去主仓去看看，但时间上就没有本地仓的快\n[[2. Areas/Blog/计算机体系机构/cs61c/SRAM vs. DRAM vs. Disk]]\nMemory Hierarchy 好的现在我们知道了cache的出现了，而下面的图是说明了对于不同的内存级别 cache cache的级别 每一级的cache就是每一个下级内存的副本\ncahe的速度在一定程度上同样影响着系统的性能.当cache中没有缓存我们想要的数据的时候，依然需要漫长的等待从主存中load数据。为了进一步提升性能，引入多级cache。前面提到的cache，称之为L1 cache（第一级cache）。我们在L1 cache 后面连接L2 cache，在L2 cache 和主存之间连接L3 cache。等级越高，速度越慢，容量越大。\nTemporal Locality(时间局部性) If a memory location is referenced then it will tend to be referenced again soon\n比如说我用过一次这个地址,我保存起来以防我下次使用\nSpatial Locality(空间局部性) If a memory location is referenced, the locations with nearby addresses will tend to be referenced soon\n比如一个数组，在我读取的时候它会把数组左右的都读取了\nCache Hit vs Cache Miss 在我要对数据进行查找的时候会出现两种情况Cache Hit \u0026Cache Miss.\ncache hit 你要查找的数据在缓存中 从缓存中检索数据并将其带到处理器.\ncache miss 你要查找的数据不在缓存中 去内存中找数据，把数据放到缓存中，带到处理器中\nCache的工作原理 现在我们来继续说一些快取的工作原理, 在此之前先来说一下的一些名词什么是 line/tag/index/offset/valid\nline: 我们将cache平均分成相等的很多块，每一个块大小称之为cache line也可以叫cache block，其大小是cache line size。 tag: Used to identify the data(用于识别数据)。每条Cache Line前都会有一个独立分配的内存来存tag，其就是内存地址的前N个bits。 $$ addressbits - offsetbits $$\noffset: Identifies the byte offset(标识字节偏移量)。一般是低位后几位。 $$ offset = log_2(line size) $$\nindex: 内存地址后续的bits则是在这–Way的是Cache Line索引，可以索引Cache Line。 Valid bit: Tells you if the data stored at a given cache line is valid(告诉您存储在给定缓存行中的数据是否有效) 一个地址访问要映射到Cache中，地址被分成三个字段：tag，set index，block offset。这样，通过一个物理地址就可以获取数据或指令在缓存中的位置(set, way, byte)\nDirect mapped cache(直接映射缓存) 优点：直接映射缓存在硬件设计上会更加简单，因此成本上也会较低。\n一句话, 我一个个的加载进入cache,当我的cache满了我就转头再来一遍\n只适合于大容量Cache\n缺点: 继续访问下面的地址时，依然会cache缺失。这就相当于每次访问数据都要从主存中读取，所以cache的存在并没有对性能提升有效,有cache颠簸(每个主存块只有一个固定位置可存放，容易产生冲突)\nTwo-way set associative cache(两路组相连缓存) Cache分了2组\n优点:减少cache颠簸出现频率\n组相联映射实际上是直接映射和全相联映射的折中方案\n缺点: 增加硬件设计复杂读、成本较高(需要比较多个cache line的TAG)\nFully Associative Cache(全相连缓存) 优点:最大程度的降低cache颠簸的频率\n只适合于小容量Cache\n缺点: 增加硬件设计复杂读、成本较高(需要比较多个cache line的TAG)\n扩展：[[More Eviction Policies]]\nTypes of Misses Comparisons 需补充\n","wordCount":"2093","inLanguage":"zh-cn","datePublished":"2023-04-14T18:40:46+08:00","dateModified":"2023-04-14T18:40:46+08:00","author":[{"@type":"Person","name":"Yeelight"}],"mainEntityOfPage":{"@type":"WebPage","@id":"https://clever-klepon-d14cb6.netlify.app/zh-cn/posts/cache/"},"publisher":{"@type":"Organization","name":"Yeelight の 小屋","logo":{"@type":"ImageObject","url":"https://clever-klepon-d14cb6.netlify.app/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://clever-klepon-d14cb6.netlify.app/zh-cn/ accesskey=h title="Yeelight の 小屋 (Alt + H)">Yeelight の 小屋</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://clever-klepon-d14cb6.netlify.app/zh-cn/about/ title=About👋><span>About👋</span></a></li><li><a href=https://clever-klepon-d14cb6.netlify.app/zh-cn/tags/ title=Tags🔖><span>Tags🔖</span></a></li><li><a href=https://clever-klepon-d14cb6.netlify.app/zh-cn/categories/ title=Categories📂><span>Categories📂</span></a></li><li><a href=https://clever-klepon-d14cb6.netlify.app/zh-cn/archives/ title=Archives📦><span>Archives📦</span></a></li><li><a href=https://clever-klepon-d14cb6.netlify.app/zh-cn/search/ title="Search🔍 (Alt + /)" accesskey=/><span>Search🔍</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://clever-klepon-d14cb6.netlify.app/zh-cn/>Home</a>&nbsp;»&nbsp;<a href=https://clever-klepon-d14cb6.netlify.app/zh-cn/posts/>Posts</a></div><h1 class=post-title>Cache Note</h1><div class=post-meta><span title='2023-04-14 18:40:46 +0800 CST'>April 14, 2023</span>&nbsp;·&nbsp;5 min&nbsp;·&nbsp;Yeelight</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#components-of-a-computer aria-label="Components of a Computer">Components of a Computer</a></li><li><a href=#memory-hierarchy aria-label="Memory Hierarchy">Memory Hierarchy</a></li><li><a href=#cache aria-label=cache>cache</a><ul><li><a href=#cache%e7%9a%84%e7%ba%a7%e5%88%ab aria-label=cache的级别>cache的级别</a></li><li><a href=#temporal-locality%e6%97%b6%e9%97%b4%e5%b1%80%e9%83%a8%e6%80%a7 aria-label="Temporal Locality(时间局部性)">Temporal Locality(时间局部性)</a></li><li><a href=#spatial-locality%e7%a9%ba%e9%97%b4%e5%b1%80%e9%83%a8%e6%80%a7 aria-label="Spatial Locality(空间局部性)">Spatial Locality(空间局部性)</a></li><li><a href=#cache-hit-vs-cache-miss aria-label="Cache Hit vs Cache Miss">Cache Hit vs Cache Miss</a><ul><li><a href=#cache-hit aria-label="cache hit">cache hit</a></li><li><a href=#cache-miss aria-label="cache miss">cache miss</a></li></ul></li></ul></li><li><a href=#cache%e7%9a%84%e5%b7%a5%e4%bd%9c%e5%8e%9f%e7%90%86 aria-label=Cache的工作原理>Cache的工作原理</a><ul><li><a href=#direct-mapped-cache%e7%9b%b4%e6%8e%a5%e6%98%a0%e5%b0%84%e7%bc%93%e5%ad%98 aria-label="Direct mapped cache(直接映射缓存)">Direct mapped cache(直接映射缓存)</a></li><li><a href=#two-way-set-associative-cache%e4%b8%a4%e8%b7%af%e7%bb%84%e7%9b%b8%e8%bf%9e%e7%bc%93%e5%ad%98 aria-label="Two-way set associative cache(两路组相连缓存)">Two-way set associative cache(两路组相连缓存)</a></li><li><a href=#fully-associative-cache%e5%85%a8%e7%9b%b8%e8%bf%9e%e7%bc%93%e5%ad%98 aria-label="Fully Associative Cache(全相连缓存)">Fully Associative Cache(全相连缓存)</a></li><li><a href=#types-of-misses aria-label="Types of Misses">Types of Misses</a></li><li><a href=#comparisons aria-label=Comparisons>Comparisons</a></li></ul></li></ul></div></details></div><div class=post-content><p>主要的资料来源: <em>cs61c</em></p><blockquote><p>cache可以说是计算机技术革命中最伟大的想法了</p></blockquote><p>想一个问题：在我们的电脑里，指令是怎么控制内存里的东西的？因为我们要运行电脑除了CPU以外我们要向外<code>拿取</code>数据才能执行一系列的指令，这样电脑才算运行起来。</p><p>让我们来看下面的这张图，这是十分完整的计算机组成结构：</p><h2 id=components-of-a-computer>Components of a Computer<a hidden class=anchor aria-hidden=true href=#components-of-a-computer>#</a></h2><p><img loading=lazy src=https://s2.loli.net/2023/04/24/Fzb3uHQBLTlqOgD.png alt="Components of a Computer"></p><p>我们可以从中看到在CPU需要运行一个进程的时候，首先会将指令告诉主存（main memory）,然后开始在主存中找地址（Address）找到后加载到在CPU内部通用寄存器（register）然后开始执行
执行完后再写入主存中。</p><blockquote><p>在这里面还有一个步骤，memory要先向disk中读取数据</p></blockquote><p>其实现实中，CPU通用寄存器的速度和主存之间存在着太大的差异。两者之间的速度大致如下关系：</p><p><img loading=lazy src=https://s2.loli.net/2023/04/24/KtvMSR7QmrXpjbl.png alt=memory-steep></p><p>Oh!!!它们相差1,000倍左右，这是无法想像的，就比如当我前1ns的时候CPU已经做完了，而我还要等1000ns的memory的时间，因此在我们看来CPU此时是空闲的，大大的浪费了。</p><p>因此，如果我们可以提升主存的速度，那么对于系统来说将会获得很大的性能提升。但我们试图提升主存的速度和容量，又期望其成本很低，这就有点难为人了。因此，我们有一种折中的方法，那就是制作一块速度极快但是容量极小的存储设备。那么其成本也不会太高。这块存储设备我们称之为<code>cache</code>。在硬件上，我们将<code>cache</code>放置在<code>CPU</code>和<code>主存</code>之间，作为主存数据的缓存。 当CPU试图从主存中load/store数据的时候， CPU会首先从cache中查找对应地址的数据是否缓存在cache 中。如果其数据缓存在cache中，直接从cache中拿到数据并返回给CPU。</p><p><img loading=lazy src=https://s2.loli.net/2023/04/24/qLhOmsTV2IE9S8p.png alt=add-cache.png></p><p>其实类比的话，我蛮喜欢CS61c里面的Library Analogy，而我自己的想法是有点像现在的物流运输：对一些物品都有一个<code>主要的仓库</code>，而也有一些<code>本地仓</code>，当我要送东西的时候我先去看看<code>本地仓</code>有没有，没有就再去<code>主仓</code>去看看，但时间上就没有本地仓的快</p><blockquote><p>[[2. Areas/Blog/计算机体系机构/cs61c/SRAM vs. DRAM vs. Disk]]</p></blockquote><h2 id=memory-hierarchy>Memory Hierarchy<a hidden class=anchor aria-hidden=true href=#memory-hierarchy>#</a></h2><p>好的现在我们知道了<code>cache</code>的出现了，而下面的图是说明了对于不同的内存级别
<img loading=lazy src=https://s2.loli.net/2023/04/24/3anw1UgNoWDZBsq.png alt=Cache-line.png></p><h2 id=cache>cache<a hidden class=anchor aria-hidden=true href=#cache>#</a></h2><h3 id=cache的级别>cache的级别<a hidden class=anchor aria-hidden=true href=#cache的级别>#</a></h3><blockquote><p>每一级的cache就是每一个下级内存的副本</p></blockquote><p>cahe的速度在一定程度上同样影响着系统的性能.当cache中没有缓存我们想要的数据的时候，依然需要漫长的等待从主存中load数据。为了进一步提升性能，引入多级cache。前面提到的cache，称之为L1 cache（第一级cache）。我们在L1 cache 后面连接L2 cache，在L2 cache 和主存之间连接L3 cache。等级越高，速度越慢，容量越大。</p><h3 id=temporal-locality时间局部性>Temporal Locality(时间局部性)<a hidden class=anchor aria-hidden=true href=#temporal-locality时间局部性>#</a></h3><blockquote><p>If a memory location is referenced then it will tend to be referenced again soon</p></blockquote><p>比如说我用过一次这个地址,我保存起来以防我下次使用</p><h3 id=spatial-locality空间局部性>Spatial Locality(空间局部性)<a hidden class=anchor aria-hidden=true href=#spatial-locality空间局部性>#</a></h3><blockquote><p>If a memory location is referenced, the locations with nearby addresses will
tend to be referenced soon</p></blockquote><p>比如一个数组，在我读取的时候它会把数组左右的都读取了</p><h3 id=cache-hit-vs-cache-miss>Cache Hit vs Cache Miss<a hidden class=anchor aria-hidden=true href=#cache-hit-vs-cache-miss>#</a></h3><p>在我要对数据进行查找的时候会出现两种情况<code>Cache Hit</code> &<code>Cache Miss</code>.</p><h4 id=cache-hit>cache hit<a hidden class=anchor aria-hidden=true href=#cache-hit>#</a></h4><p>你要查找的数据<code>在缓存中</code> 从缓存中检索数据并将其带到处理器.</p><h4 id=cache-miss>cache miss<a hidden class=anchor aria-hidden=true href=#cache-miss>#</a></h4><p>你要查找的数据<code>不在缓存中</code> 去内存中找数据，把数据放到缓存中，带到处理器中</p><h2 id=cache的工作原理>Cache的工作原理<a hidden class=anchor aria-hidden=true href=#cache的工作原理>#</a></h2><p>现在我们来继续说一些快取的工作原理, 在此之前先来说一下的一些名词什么是 <code>line/tag/index/offset/valid</code></p><ul><li><strong>line:</strong> 我们将cache平均分成相等的很多块，每一个块大小称之为<code>cache line</code>也可以叫<code>cache block</code>，其大小是<code>cache line size</code>。</li><li><strong>tag:</strong> Used to identify the data(用于识别数据)。每条Cache Line前都会有一个独立分配的内存来存tag，其就是内存地址的前N个bits。</li></ul><p>$$ addressbits - offsetbits $$</p><ul><li><strong>offset:</strong> Identifies the byte offset(标识字节偏移量)。一般是低位后几位。</li></ul><p>$$ offset = log_2(line size) $$</p><ul><li><strong>index:</strong> 内存地址后续的bits则是在这&ndash;Way的是Cache Line索引，可以索引Cache Line。</li><li><strong>Valid bit:</strong> Tells you if the data stored at a given cache line is valid(告诉您存储在给定缓存行中的数据是否有效)</li></ul><blockquote><p>一个地址访问要映射到Cache中，地址被分成三个字段：tag，set index，block offset。这样，通过一个物理地址就可以获取数据或指令在缓存中的位置(set, way, byte)</p></blockquote><p><img loading=lazy src=https://s2.loli.net/2023/04/24/mHdMoveGWXkiNL4.png alt=line-block.png></p><h3 id=direct-mapped-cache直接映射缓存>Direct mapped cache(直接映射缓存)<a hidden class=anchor aria-hidden=true href=#direct-mapped-cache直接映射缓存>#</a></h3><p>优点：直接映射缓存在硬件设计上会更加简单，因此成本上也会较低。</p><blockquote><p>一句话, 我一个个的加载进入cache,当我的cache满了我就转头再来一遍</p><p>只适合于<strong>大容量</strong>Cache</p></blockquote><p>缺点: 继续访问下面的地址时，依然会cache缺失。这就相当于每次访问数据都要从主存中读取，所以cache的存在并没有对性能提升有效,有<code>cache颠簸</code>(每个主存块只有一个固定位置可存放，容易产生冲突)</p><p><img loading=lazy src=https://s2.loli.net/2023/04/24/xeav7mlIDAyOwqK.png alt="Direct Mapped.png"></p><p><img loading=lazy src=https://s2.loli.net/2023/04/24/4EYI7Va1S5lKgow.png alt="Direct Mapped-cache.png"></p><h3 id=two-way-set-associative-cache两路组相连缓存>Two-way set associative cache(两路组相连缓存)<a hidden class=anchor aria-hidden=true href=#two-way-set-associative-cache两路组相连缓存>#</a></h3><p><strong>Cache分了2组</strong></p><p>优点:减少cache颠簸出现频率</p><blockquote><p>组相联映射实际上是直接映射和全相联映射的折中方案</p></blockquote><p>缺点: 增加硬件设计复杂读、成本较高(需要比较多个cache line的TAG)</p><p><img loading=lazy src=https://s2.loli.net/2023/04/24/yXE8J6RMo9F3Vxq.png alt="set associative-cache.png"></p><h3 id=fully-associative-cache全相连缓存>Fully Associative Cache(全相连缓存)<a hidden class=anchor aria-hidden=true href=#fully-associative-cache全相连缓存>#</a></h3><p>优点:最大程度的降低cache颠簸的频率</p><blockquote><p>只适合于<strong>小容量</strong>Cache</p></blockquote><p>缺点: 增加硬件设计复杂读、成本较高(需要比较多个cache line的TAG)</p><p>扩展：[[More Eviction Policies]]</p><p><img loading=lazy src=https://s2.loli.net/2023/04/24/76uSATyrPno1eYf.png alt="Fully Associative.png"></p><p><img loading=lazy src=https://s2.loli.net/2023/04/24/3VYzGo9dkgHwcrS.png alt="Required to Check for Hit.png"></p><h3 id=types-of-misses>Types of Misses<a hidden class=anchor aria-hidden=true href=#types-of-misses>#</a></h3><p><img loading=lazy src=https://s2.loli.net/2023/04/24/M4Fc1g6k5OrfBpj.png alt="Types of Misses"></p><h3 id=comparisons>Comparisons<a hidden class=anchor aria-hidden=true href=#comparisons>#</a></h3><p><img loading=lazy src=https://s2.loli.net/2023/04/24/iICnWkpOMcFtKZH.png alt=Comparisons.png></p><p><strong>需补充</strong></p></div><footer class=post-footer><ul class=post-tags></ul><nav class=paginav><a class=prev href=https://clever-klepon-d14cb6.netlify.app/zh-cn/posts/makefile/><span class=title>«</span><br><span>MakeFile使用笔记</span></a>
<a class=next href=https://clever-klepon-d14cb6.netlify.app/zh-cn/posts/csapp02/><span class=title>»</span><br><span>二.程序的机器级表示(CSAPP)</span></a></nav><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share Cache Note on twitter" href="https://twitter.com/intent/tweet/?text=Cache%20Note&amp;url=https%3a%2f%2fclever-klepon-d14cb6.netlify.app%2fzh-cn%2fposts%2fcache%2f&amp;hashtags="><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Cache Note on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fclever-klepon-d14cb6.netlify.app%2fzh-cn%2fposts%2fcache%2f&amp;title=Cache%20Note&amp;summary=Cache%20Note&amp;source=https%3a%2f%2fclever-klepon-d14cb6.netlify.app%2fzh-cn%2fposts%2fcache%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Cache Note on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fclever-klepon-d14cb6.netlify.app%2fzh-cn%2fposts%2fcache%2f&title=Cache%20Note"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Cache Note on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fclever-klepon-d14cb6.netlify.app%2fzh-cn%2fposts%2fcache%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Cache Note on whatsapp" href="https://api.whatsapp.com/send?text=Cache%20Note%20-%20https%3a%2f%2fclever-klepon-d14cb6.netlify.app%2fzh-cn%2fposts%2fcache%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Cache Note on telegram" href="https://telegram.me/share/url?text=Cache%20Note&amp;url=https%3a%2f%2fclever-klepon-d14cb6.netlify.app%2fzh-cn%2fposts%2fcache%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></div></footer></article></main><footer class=footer><span>&copy; 2023 <a href=https://clever-klepon-d14cb6.netlify.app/zh-cn/>Yeelight の 小屋</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>